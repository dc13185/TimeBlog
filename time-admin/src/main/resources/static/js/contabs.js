$(function(){function calSumWidth(elements){var width=0;$(elements).each(function(){width+=$(this).outerWidth(true)});return width}function scrollToTab(element){var marginLeftVal=calSumWidth($(element).prevAll()),marginRightVal=calSumWidth($(element).nextAll());var tabOuterWidth=calSumWidth($(".content-tabs").children().not(".J_menuTabs"));var visibleWidth=$(".content-tabs").outerWidth(true)-tabOuterWidth;var scrollVal=0;if($(".page-tabs-content").outerWidth()<visibleWidth){scrollVal=0}else if(marginRightVal<=(visibleWidth-$(element).outerWidth(true)-$(element).next().outerWidth(true))){if((visibleWidth-$(element).next().outerWidth(true))>marginRightVal){scrollVal=marginLeftVal;var tabElement=element;while((scrollVal-$(tabElement).outerWidth())>($(".page-tabs-content").outerWidth()-visibleWidth)){scrollVal-=$(tabElement).prev().outerWidth();tabElement=$(tabElement).prev()}}}else if(marginLeftVal>(visibleWidth-$(element).outerWidth(true)-$(element).prev().outerWidth(true))){scrollVal=marginLeftVal-$(element).prev().outerWidth(true)}$('.page-tabs-content').animate({marginLeft:0-scrollVal+'px'},"fast")}function scrollTabLeft(){var marginLeftVal=Math.abs(parseInt($('.page-tabs-content').css('margin-left')));var tabOuterWidth=calSumWidth($(".content-tabs").children().not(".J_menuTabs"));var visibleWidth=$(".content-tabs").outerWidth(true)-tabOuterWidth;var scrollVal=0;if($(".page-tabs-content").width()<visibleWidth){return false}else{var tabElement=$(".J_menuTab:first");var offsetVal=0;while((offsetVal+$(tabElement).outerWidth(true))<=marginLeftVal){offsetVal+=$(tabElement).outerWidth(true);tabElement=$(tabElement).next()}offsetVal=0;if(calSumWidth($(tabElement).prevAll())>visibleWidth){while((offsetVal+$(tabElement).outerWidth(true))<(visibleWidth)&&tabElement.length>0){offsetVal+=$(tabElement).outerWidth(true);tabElement=$(tabElement).prev()}scrollVal=calSumWidth($(tabElement).prevAll())}}$('.page-tabs-content').animate({marginLeft:0-scrollVal+'px'},"fast")}function scrollTabRight(){var marginLeftVal=Math.abs(parseInt($('.page-tabs-content').css('margin-left')));var tabOuterWidth=calSumWidth($(".content-tabs").children().not(".J_menuTabs"));var visibleWidth=$(".content-tabs").outerWidth(true)-tabOuterWidth;var scrollVal=0;if($(".page-tabs-content").width()<visibleWidth){return false}else{var tabElement=$(".J_menuTab:first");var offsetVal=0;while((offsetVal+$(tabElement).outerWidth(true))<=marginLeftVal){offsetVal+=$(tabElement).outerWidth(true);tabElement=$(tabElement).next()}offsetVal=0;while((offsetVal+$(tabElement).outerWidth(true))<(visibleWidth)&&tabElement.length>0){offsetVal+=$(tabElement).outerWidth(true);tabElement=$(tabElement).next()}scrollVal=calSumWidth($(tabElement).prevAll());if(scrollVal>0){$('.page-tabs-content').animate({marginLeft:0-scrollVal+'px'},"fast")}}}$(".J_menuItem").each(function(index){if(!$(this).attr('data-index')){$(this).attr('data-index',index)}});function menuItem(){var dataUrl=$(this).attr('href'),dataIndex=$(this).data('index'),menuName=$.trim($(this).text()),flag=true;if(dataUrl==undefined||$.trim(dataUrl).length==0)return false;$('.J_menuTab').each(function(){if($(this).data('id')==dataUrl){if(!$(this).hasClass('active')){$(this).addClass('active').siblings('.J_menuTab').removeClass('active');scrollToTab(this);$('.J_mainContent .J_iframe').each(function(){if($(this).data('id')==dataUrl){$(this).show().siblings('.J_iframe').hide();return false}})}flag=false;return false}});if(flag){var str='<a href="javascript:;" class="active J_menuTab" data-id="'+dataUrl+'">'+menuName+' <i class="fa fa-times-circle"></i></a>';$('.J_menuTab').removeClass('active');var str1='<iframe class="J_iframe" name="iframe'+dataIndex+'" width="100%" height="100%" src="'+dataUrl+'" frameborder="0" data-id="'+dataUrl+'" seamless></iframe>';$('.J_mainContent').find('iframe.J_iframe').hide().parents('.J_mainContent').append(str1);$('.J_menuTabs .page-tabs-content').append(str);scrollToTab($('.J_menuTab.active'))}return false}$('.J_menuItem').on('click',menuItem);function closeTab(){var closeTabId=$(this).parents('.J_menuTab').data('id');var currentWidth=$(this).parents('.J_menuTab').width();if($(this).parents('.J_menuTab').hasClass('active')){if($(this).parents('.J_menuTab').next('.J_menuTab').size()){var activeId=$(this).parents('.J_menuTab').next('.J_menuTab:eq(0)').data('id');$(this).parents('.J_menuTab').next('.J_menuTab:eq(0)').addClass('active');$('.J_mainContent .J_iframe').each(function(){if($(this).data('id')==activeId){$(this).show().siblings('.J_iframe').hide();return false}});var marginLeftVal=parseInt($('.page-tabs-content').css('margin-left'));if(marginLeftVal<0){$('.page-tabs-content').animate({marginLeft:(marginLeftVal+currentWidth)+'px'},"fast")}$(this).parents('.J_menuTab').remove();$('.J_mainContent .J_iframe').each(function(){if($(this).data('id')==closeTabId){$(this).remove();return false}})}if($(this).parents('.J_menuTab').prev('.J_menuTab').size()){var activeId=$(this).parents('.J_menuTab').prev('.J_menuTab:last').data('id');$(this).parents('.J_menuTab').prev('.J_menuTab:last').addClass('active');$('.J_mainContent .J_iframe').each(function(){if($(this).data('id')==activeId){$(this).show().siblings('.J_iframe').hide();return false}});$(this).parents('.J_menuTab').remove();$('.J_mainContent .J_iframe').each(function(){if($(this).data('id')==closeTabId){$(this).remove();return false}})}}else{$(this).parents('.J_menuTab').remove();$('.J_mainContent .J_iframe').each(function(){if($(this).data('id')==closeTabId){$(this).remove();return false}});scrollToTab($('.J_menuTab.active'))}return false}$('.J_menuTabs').on('click','.J_menuTab i',closeTab);function closeOtherTabs(){$('.page-tabs-content').children("[data-id]").not(":first").not(".active").each(function(){$('.J_iframe[data-id="'+$(this).data('id')+'"]').remove();$(this).remove()});$('.page-tabs-content').css("margin-left","0")}$('.J_tabCloseOther').on('click',closeOtherTabs);function showActiveTab(){scrollToTab($('.J_menuTab.active'))}$('.J_tabShowActive').on('click',showActiveTab);function activeTab(){if(!$(this).hasClass('active')){var currentId=$(this).data('id');$('.J_mainContent .J_iframe').each(function(){if($(this).data('id')==currentId){$(this).show().siblings('.J_iframe').hide();return false}});$(this).addClass('active').siblings('.J_menuTab').removeClass('active');scrollToTab(this)}}$('.J_menuTabs').on('click','.J_menuTab',activeTab);function refreshTab(){var target=$('.J_iframe[data-id="'+$(this).data('id')+'"]');var url=target.attr('src')}$('.J_menuTabs').on('dblclick','.J_menuTab',refreshTab);$('.J_tabLeft').on('click',scrollTabLeft);$('.J_tabRight').on('click',scrollTabRight);$('.J_tabCloseAll').on('click',function(){$('.page-tabs-content').children("[data-id]").not(":first").each(function(){$('.J_iframe[data-id="'+$(this).data('id')+'"]').remove();$(this).remove()});$('.page-tabs-content').children("[data-id]:first").each(function(){$('.J_iframe[data-id="'+$(this).data('id')+'"]').show();$(this).addClass("active")});$('.page-tabs-content').css("margin-left","0")})});
